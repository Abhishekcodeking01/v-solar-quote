<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>On-Grid Quotation – V-Sustain Solar Solutions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
  <style>
    /* small helper for inline fields if not already in style.css */
    .inline-fields {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
    }
    .toggle.small {
      font-size: 12px;
    }
    .manual-price-input {
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="page">
    <header class="header">
      <h1>On-Grid Solar Quotation</h1>
      <a href="../index.html" class="back-btn">← Back to Home</a>
    </header>

    <!-- GLOBAL MARGIN -->
    <section class="margin-box">
      <h2>Global Margin</h2>
      <label>Common Margin (%)</label>
      <input type="number" id="globalMargin" value="20" />
      <p class="note">
        Each product card can use this common margin or a custom margin.
        Manual price override works on top of the dealer price.
      </p>
    </section>

    <!-- SYSTEM CAPACITY -->
    <section class="card">
      <div class="card-header">
        <h2>1. System Capacity (kW)</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="capacity" />
          <span></span> Enable
        </label>
      </div>
      <input type="number" id="systemKW" placeholder="Enter required kW" />
    </section>

    <!-- INVERTER -->
    <section class="card">
      <div class="card-header">
        <h2>2. On-Grid Inverter</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="inverter" />
          <span></span> Enable
        </label>
        <label class="toggle">
          <input type="checkbox" checked class="margin-toggle" data-target="inverter" />
          <span></span> Use Global Margin
        </label>
      </div>

      <label>Select Inverter Model</label>
      <select id="inverterSelect"></select>

      <div class="inline-fields">
        <div>
          <label>Dealer Price (Auto)</label>
          <input type="text" id="inverterDealer" readonly />
        </div>
        <div>
          <label>Final Rate (after Margin)</label>
          <input type="text" id="inverterRate" readonly />
        </div>
      </div>

      <div class="inline-fields">
        <div>
          <label>GST %</label>
          <input type="text" id="inverterGst" readonly />
        </div>
        <div>
          <label>Estimated Total (incl. GST)</label>
          <input type="text" id="inverterTotal" readonly />
        </div>
      </div>

      <div class="inline-fields">
        <div>
          <label>Custom Margin (%)</label>
          <input type="number" class="custom-margin" data-target="inverter" />
        </div>
        <div>
          <label class="toggle small">
            <input type="checkbox" class="manual-price-toggle" data-target="inverter" />
            <span></span> Manual Price Override
          </label>
          <input
            type="number"
            class="manual-price-input"
            data-target="inverter"
            placeholder="Override Dealer Price"
          />
        </div>
      </div>
    </section>

    <!-- SOLAR PANELS -->
    <section class="card">
      <div class="card-header">
        <h2>3. Solar Panels</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="panels" />
          <span></span> Enable
        </label>
        <label class="toggle">
          <input type="checkbox" checked class="margin-toggle" data-target="panels" />
          <span></span> Use Global Margin
        </label>
      </div>

      <label>Select Panel Model</label>
      <select id="panelSelect"></select>

      <div class="inline-fields">
        <div>
          <label>Dealer Price / Panel (Auto)</label>
          <input type="text" id="panelDealer" readonly />
        </div>
        <div>
          <label>Rate / Panel (after Margin)</label>
          <input type="text" id="panelRate" readonly />
        </div>
      </div>

      <label>Auto-calculated Quantity</label>
      <input type="number" id="panelQty" readonly />

      <div class="inline-fields">
        <div>
          <label>DC Capacity</label>
          <input type="text" id="panelCapacityKw" readonly />
        </div>
        <div>
          <label>GST %</label>
          <input type="text" id="panelGst" readonly />
        </div>
        <div>
          <label>Estimated Total (incl. GST)</label>
          <input type="text" id="panelTotal" readonly />
        </div>
      </div>

      <div class="inline-fields">
        <div>
          <label>Custom Margin (%)</label>
          <input type="number" class="custom-margin" data-target="panels" />
        </div>
        <div>
          <label class="toggle small">
            <input type="checkbox" class="manual-price-toggle" data-target="panels" />
            <span></span> Manual Price Override
          </label>
          <input
            type="number"
            class="manual-price-input"
            data-target="panels"
            placeholder="Override Dealer Price / Panel"
          />
        </div>
      </div>
    </section>

    <!-- METER (no price, just type selection for now) -->
    <section class="card">
      <div class="card-header">
        <h2>4. Bi-Directional Meter</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="meter" />
          <span></span> Enable
        </label>
      </div>
      <select id="meterType">
        <option value="Single Phase">Single Phase</option>
        <option value="Three Phase">Three Phase</option>
      </select>
    </section>

    <!-- ACDB -->
    <section class="card">
      <div class="card-header">
        <h2>5. ACDB</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="acdb" />
          <span></span> Enable
        </label>
        <label class="toggle">
          <input type="checkbox" checked class="margin-toggle" data-target="acdb" />
          <span></span> Use Global Margin
        </label>
      </div>

      <label>Select ACDB</label>
      <select id="acdbSelect"></select>

      <div class="inline-fields">
        <div>
          <label>Dealer Price (Auto)</label>
          <input type="text" id="acdbDealer" readonly />
        </div>
        <div>
          <label>Effective Rate (after Margin)</label>
          <input type="text" id="acdbRate" readonly />
        </div>
      </div>

      <div class="inline-fields">
        <div>
          <label>Custom Margin (%)</label>
          <input type="number" class="custom-margin" data-target="acdb" />
        </div>
        <div>
          <label class="toggle small">
            <input type="checkbox" class="manual-price-toggle" data-target="acdb" />
            <span></span> Manual Price Override
          </label>
          <input
            type="number"
            class="manual-price-input"
            data-target="acdb"
            placeholder="Override Dealer Price"
          />
        </div>
      </div>
    </section>

    <!-- DCDB -->
    <section class="card">
      <div class="card-header">
        <h2>6. DCDB</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="dcdb" />
          <span></span> Enable
        </label>
        <label class="toggle">
          <input type="checkbox" checked class="margin-toggle" data-target="dcdb" />
          <span></span> Use Global Margin
        </label>
      </div>

      <label>Select DCDB</label>
      <select id="dcdbSelect"></select>

      <div class="inline-fields">
        <div>
          <label>Dealer Price (Auto)</label>
          <input type="text" id="dcdbDealer" readonly />
        </div>
        <div>
          <label>Effective Rate (after Margin)</label>
          <input type="text" id="dcdbRate" readonly />
        </div>
      </div>

      <div class="inline-fields">
        <div>
          <label>Custom Margin (%)</label>
          <input type="number" class="custom-margin" data-target="dcdb" />
        </div>
        <div>
          <label class="toggle small">
            <input type="checkbox" class="manual-price-toggle" data-target="dcdb" />
            <span></span> Manual Price Override
          </label>
          <input
            type="number"
            class="manual-price-input"
            data-target="dcdb"
            placeholder="Override Dealer Price"
          />
        </div>
      </div>
    </section>

    <!-- AC CABLE -->
    <section class="card">
      <div class="card-header">
        <h2>7. AC Cable</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="accable" />
          <span></span> Enable
        </label>
        <label class="toggle">
          <input type="checkbox" checked class="margin-toggle" data-target="accable" />
          <span></span> Use Global Margin
        </label>
      </div>

      <label>Gauge</label>
      <input type="text" id="acGauge" />

      <label>Quantity (m)</label>
      <input type="number" id="acQty" />

      <label>Price / meter (Base)</label>
      <input type="number" id="acPrice" />

      <label>Custom Margin (%)</label>
      <input type="number" class="custom-margin" data-target="accable" />
    </section>

    <!-- EARTHING CABLE -->
    <section class="card">
      <div class="card-header">
        <h2>8. Earthing Cable</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="earthing" />
          <span></span> Enable
        </label>
        <label class="toggle">
          <input type="checkbox" checked class="margin-toggle" data-target="earthing" />
          <span></span> Use Global Margin
        </label>
      </div>

      <label>Gauge</label>
      <input type="text" id="earthGauge" />

      <label>Quantity (m)</label>
      <input type="number" id="earthQty" />

      <label>Price / meter (Base)</label>
      <input type="number" id="earthPrice" />

      <label>Custom Margin (%)</label>
      <input type="number" class="custom-margin" data-target="earthing" />
    </section>

    <!-- INSTALLATION -->
    <section class="card">
      <div class="card-header">
        <h2>9. Installation Charges</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="installation" />
          <span></span> Enable
        </label>
      </div>

      <p class="note">Auto: kW × 5000 (you can manually adjust the total amount below).</p>
      <label>Total Installation Amount (Editable)</label>
      <input type="number" id="installationCost" />
    </section>

    <!-- STRUCTURE -->
    <section class="card">
      <div class="card-header">
        <h2>10. Structure</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="structure" />
          <span></span> Enable
        </label>
      </div>
      <p class="note">Auto: kW × 8000 (you can manually adjust the total amount below).</p>
      <label>Total Structure Amount (Editable)</label>
      <input type="number" id="structureCost" />
    </section>

    <!-- LIGHTNING ARRESTOR -->
    <section class="card">
      <div class="card-header">
        <h2>11. Lightning Arrestor</h2>
        <label class="toggle">
          <input type="checkbox" checked data-target="lightning" />
          <span></span> Enable
        </label>
        <label class="toggle">
          <input type="checkbox" checked class="margin-toggle" data-target="lightning" />
          <span></span> Use Global Margin
        </label>
      </div>

      <label>Quantity</label>
      <input type="number" id="lightQty" />

      <label>Price (Base)</label>
      <input type="number" id="lightPrice" />

      <label>Custom Margin (%)</label>
      <input type="number" class="custom-margin" data-target="lightning" />
    </section>

    <!-- CUSTOM PRODUCTS -->
    <section class="card">
      <h2>Custom Products</h2>
      <div id="customProducts"></div>
      <button id="addCustomProduct" class="add-btn">+ Add Product</button>
    </section>

    <!-- BUTTONS -->
    <section class="button-row">
      <button id="generateDetailed">Generate Detailed Quotation</button>
      <button id="generateSummary" class="alt">Generate Summary Quotation</button>
    </section>

    <!-- Not used (we now open new window) -->
    <section id="quotationOutput" style="display:none;"></section>
  </div>

  <script src="script.js"></script>
</body>
</html>
